
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>More on Numerical ODEs &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lecture-12-symplectic-integrators';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="From ODE to PDE" href="lecture-13-pde.html" />
    <link rel="prev" title="Intro to Numerical Integration" href="lecture-11-ode-intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="My sample book - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to 7870
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 1. Linear Algebra</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture-01-intro_vectors.html">A Deeper look at Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-02-coding_matrices_in_python.html">Linear Algebra in Python with Numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-03-matrix_decompositions.html">Eigenvectors, Unitary Matrices, and Matrix Decompositions</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-04-linear_regression.html">Linear Regression and Least Squares</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 2. Probability</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture-05-probability.html">Intro to Probability</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-05a-random-in-numpy.html">Using Random Numbers in Numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-06-bayes-rule.html">Conditional Probability and Bayes Rule</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-07-bayesian-inference.html">Bayesian Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-08-monte-carlo.html">Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-09-mcmc.html">Markov Chain Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-10-metropolis-hastings.html">Detailed Balance and the Metropolis-Hastings Algorithm</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 3. Numerical Differential Equations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture-11-ode-intro.html">Intro to Numerical Integration</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">More on Numerical ODEs</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-13-pde.html">From ODE to PDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-14-optimization.html">Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-15-nonlinear-regression.html">Nonlinear Regression</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Flecture-12-symplectic-integrators.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/lecture-12-symplectic-integrators.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>More on Numerical ODEs</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-symmetric-integrators">Time-symmetric integrators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-leapfrog-integrator">The Leapfrog Integrator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symplectic-integrators">Symplectic Integrators</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-error-in-ode-integrators">Evaluating error in ODE integrators.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="more-on-numerical-odes">
<h1>More on Numerical ODEs<a class="headerlink" href="#more-on-numerical-odes" title="Link to this heading">#</a></h1>
<section id="learning-objectives">
<h2>Learning Objectives<a class="headerlink" href="#learning-objectives" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Introduce time-symmetric integrators that preserve the energy.</p></li>
<li><p>Derive the equations for the leapfrog integrator, as commonly used in molecular dynamics.</p></li>
<li><p>Discuss the concept of a <code class="docutils literal notranslate"><span class="pre">symplectic</span> <span class="pre">integrator</span></code>.</p></li>
<li><p>Analyse the error in an ODE integrator.</p></li>
</ul>
</section>
<section id="time-symmetric-integrators">
<h2>Time-symmetric integrators<a class="headerlink" href="#time-symmetric-integrators" title="Link to this heading">#</a></h2>
<p>So far, we have introduced two approaches to solving a generic ODE</p>
<div class="math notranslate nohighlight">
\[
\frac{dy(t)}{dt} = f(t, y(t))
\]</div>
<p>where (f) is a function of time (t) and the value of the function at that time, (y(t)).  We have also discussed how to solve this equation numerically, using the forward and backward Euler methods, given respectively by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
    y(t + \Delta t) &amp;= y(t) + \Delta t f(t, y(t)) \\
    y(t + \Delta t) &amp;= y(t) + \Delta t f(t+ \Delta t, y(t + \Delta t ))
\end{split}
\end{split}\]</div>
<p>Unfortunately, we are not quite happy with either solution.  Applying these to a simple harmonic oscillator, we saw that the energy either increases to infinity (forward Euler) or decreases to zero (backward Euler).<br />
To address this, we will try to introduce integrators that obey the symmetries of a physical system.
One classic one is time-reversal symmetry: if we run the dynamics up to time <span class="math notranslate nohighlight">\(T\)</span>, reverse the arrow of time, and then run the dynamics back to time <span class="math notranslate nohighlight">\(0\)</span>, we should end up where we started.<br />
For inspiration, we again two turn Riemann integration, and find two integrators that obey this symmetry.  The first is the trapezoidal rule: numerically integrating a function using trapezoid rule gives the same answer if we march left or right.
If we generalize this to the case of ODEs, we can write down a time-symmetric integrator as follows:</p>
<div class="math notranslate nohighlight">
\[
    y(t + \Delta t) = y(t) + \frac{\Delta t}{2} \left( f(t, y(t)) + f(t + \Delta t, y(t + \Delta t)) \right) 
\]</div>
<p>A quick calculation shows that this is symmetric: integrating backwards in time from <span class="math notranslate nohighlight">\(y(t + \Delta t)\)</span>  puts us back at <span class="math notranslate nohighlight">\(y(t)\)</span>.
Note that this is an implicit integrator: we need to know the value of <span class="math notranslate nohighlight">\(y(t + \Delta t)\)</span> in order to evaluate the function at that point.<br />
As with backward Euler, we will need to find a way to solve this equation.  However, the stability and accuracy of this integrator makes this often well worth it.</p>
<p>The second time-symmetric integrator is inspired by the midpoint rule.  To write this, we actually take a step from two steps back, <span class="math notranslate nohighlight">\(y(t - \Delta t)\)</span>, to <span class="math notranslate nohighlight">\(y(t + \Delta t)\)</span>, and then evaluate the function at the midpoint, <span class="math notranslate nohighlight">\(y(t)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
    y(t + \Delta t) = y(t ) + \Delta t f(t + \Delta t / 2, y(t + \Delta t / 2)) 
\]</div>
<p>This leaves us with a problem: how do we evaluate the function at the midpoint?  A simple way is we use the same update for the midpoints as well: we combine this update with an update on the midpoint steps:</p>
<div class="math notranslate nohighlight">
\[
    y(t + \Delta t / 2) = y(t - \Delta t / 2) + \Delta t f(t , y(t )) 
\]</div>
<p>(Equivalently, we could have doubled our timestep to <span class="math notranslate nohighlight">\(2 \Delta t\)</span>.)
Unlike the trapezoidal rule, this is an explicit integrator: we can evaluate the function at the midpoint without needing to know the value of <span class="math notranslate nohighlight">\(y(t + \Delta t)\)</span>.</p>
</section>
<section id="the-leapfrog-integrator">
<h2>The Leapfrog Integrator<a class="headerlink" href="#the-leapfrog-integrator" title="Link to this heading">#</a></h2>
<p>This integrator based on the midpoint rule is particularly convenient when working with Newtonian mechanics.  In this case, we can write the equations of motion as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
    \frac{dx}{dt} &amp;= v \\
    \frac{dv}{dt} &amp;= \frac{1}{M} F(t, x)
\end{split}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(F\)</span> is the force.  (Recall that for Hamiltonian systems, the force is given by <span class="math notranslate nohighlight">\(F = - \partial U / \partial x\)</span>.)  We can then write the leapfrog integrator as follows:</p>
<div class="math notranslate nohighlight">
\[
\begin{split}
x(t + \Delta t) = x(t) + \Delta t v(t + \Delta t / 2)
v(t + \Delta t / 2) = v(t - \Delta t / 2) + \frac{\Delta t}{M} F(t, x(t))
\end{split}
\]</div>
<p>Note that we never need to evaluate the force at the midpoint, <span class="math notranslate nohighlight">\(F(t + \Delta t / 2, x(t + \Delta t / 2))\)</span>.  We still need to take only a single evaluation of the force, as we would if we were to use forwards or backwards Euler.
However, this integrator is time-symmetric: we have achieved an important physical symmetry.</p>
<section id="symplectic-integrators">
<h3>Symplectic Integrators<a class="headerlink" href="#symplectic-integrators" title="Link to this heading">#</a></h3>
<p>In fact, both the the trapezoidal rule and the leapfrog integrators obey a special property when applied to Hamiltonian dynamics (i.e., where the force is given by <span class="math notranslate nohighlight">\(F = - \partial U / \partial x\)</span>).<br />
This property is symplecticity.  While an in-depth treatment of symplecticity is beyond the scope of this course, in words symplecity means that phase space volume is preserved as the dynamics progresses.
Symplecticity is true for the Hamiltonian equations of motion, and is deeply related to the conservation of energy and angular momentum.<br />
The trapezoidal rule and leapfrog integrators are both symplectic integrators.  As such, they preserve an invariant that is close to, but not exactly, the system’s energy.</p>
</section>
</section>
<section id="evaluating-error-in-ode-integrators">
<h2>Evaluating error in ODE integrators.<a class="headerlink" href="#evaluating-error-in-ode-integrators" title="Link to this heading">#</a></h2>
<p>So how big of an error do these integrators make?  One way to evaluate this is the error in integrating from time <span class="math notranslate nohighlight">\(0\)</span> to time <span class="math notranslate nohighlight">\(T\)</span>.  As a simple example, let’s consider the forwards Euler integrator, reproduced below for your converience.</p>
<div class="math notranslate nohighlight">
\[
    y(t + \Delta t) = y(t) + \Delta t f(t, y(t)) 
\]</div>
<p>We will consider the simplified case where <span class="math notranslate nohighlight">\(f\)</span> is only a function of <span class="math notranslate nohighlight">\(y\)</span>, and not <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>We first ask, “how big is the error in the first step?”  To do this, we denote the <em>true</em> solution at time <span class="math notranslate nohighlight">\(t + \Delta t\)</span> as <span class="math notranslate nohighlight">\(y^*(t + \Delta t)\)</span>.  Taylor expanding around <span class="math notranslate nohighlight">\(y(t)\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[
y^*(t + \Delta t) = y(t) + \Delta t f(y(t)) + \frac{1}{2} \Delta t^2 \frac{\partial f}{\partial y} f(y(t))  + O(\Delta t^3)
\]</div>
<p>where we have used the fact that <span class="math notranslate nohighlight">\(dy/dt = f(y)\)</span> in the chain rule.
Subtracting this from the forward Euler prediction, we find that the error in the first step is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
    \epsilon_1 &amp;= y^*(t + \Delta t) - y(t + \Delta t) \\
    &amp;= \frac{1}{2} \Delta t^2 \frac{\partial f}{\partial y} f(y(t)) + O(\Delta t^3)
\end{split}
\end{split}\]</div>
<p>implyiing that the error scales as <span class="math notranslate nohighlight">\(\Delta t^2\)</span>.
Now, to go from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(T\)</span>, we need to take <span class="math notranslate nohighlight">\(N = T / \Delta t\)</span> steps. If at each step the error we accumulate scalers as <span class="math notranslate nohighlight">\(\Delta t^2\)</span>, we expect our total error to be <span class="math notranslate nohighlight">\(O(\Delta t)\)</span>.
We consequently say that the forward Euler integrator is accurate to “first order” in <span class="math notranslate nohighlight">\(\Delta t\)</span>.
By very similar logic, we can show that the backward Euler integrator is also first order in <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<p>The trapezoidal rule, on the other hand, is <em>second order</em> in <span class="math notranslate nohighlight">\(\Delta t\)</span>.<br />
For simplicity, we consider the case where <span class="math notranslate nohighlight">\(f\)</span> is only a function of <span class="math notranslate nohighlight">\(y\)</span>, and not <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>We first expand the value of <span class="math notranslate nohighlight">\(f(y(t + \Delta t))\)</span> around <span class="math notranslate nohighlight">\(y(t)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
f(y(t + \Delta t)) =
f(t, y(t)) + \Delta t \frac{\partial f}{\partial t} (y(t)) f(y(t))  + O(\Delta t^2) 
\]</div>
<p>Substituting this into the trapezoidal rule, we find that the trapezoidal rule prediction obeys</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
y(t) =&amp; y(t) + \frac{\Delta t}{2}  f(t, y(t))   + \frac{\Delta t}{2} \left( f(t, y(t)) + \Delta t \frac{\partial f}{\partial t} (y(t)) f(y(t))  + O(\Delta t^2) \right) + O(\Delta t^3) \\
 =&amp; y(t) + \Delta t f(t, y(t)) + \frac{1}{2} \Delta t^2 \frac{\partial f}{\partial t} (y(t)) f(y(t))  + O(\Delta t^3)
\end{split}
\end{split}\]</div>
<p>This is, to <em>third</em> order, the same as the true solution. Consequently, we expect the total error from integrating from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(T\)</span> to be <span class="math notranslate nohighlight">\(O(\Delta t^2)\)</span>, and we say that the trapezoidal rule is a <em>second order</em> integrator.
The leapfrog integrator is also a second order integrator.  What this means is that, in general, we expect the leapfrog and trapezoidal rule to be more accurate than the forward and backward Euler integrators.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The best reference on integrators that I know of for applications to chemical systems is <strong>Molecular Dynamics</strong> by Leimkuhler and Matthews.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lecture-11-ode-intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Intro to Numerical Integration</p>
      </div>
    </a>
    <a class="right-next"
       href="lecture-13-pde.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">From ODE to PDE</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-symmetric-integrators">Time-symmetric integrators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-leapfrog-integrator">The Leapfrog Integrator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symplectic-integrators">Symplectic Integrators</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-error-in-ode-integrators">Evaluating error in ODE integrators.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Erik Thiede
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>