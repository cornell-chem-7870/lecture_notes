Traceback (most recent call last):
  File "/home/erik/mambaforge/envs/compmethods/lib/python3.11/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/erik/mambaforge/envs/compmethods/lib/python3.11/site-packages/nbclient/client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/erik/mambaforge/envs/compmethods/lib/python3.11/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/erik/mambaforge/envs/compmethods/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/erik/mambaforge/envs/compmethods/lib/python3.11/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/home/erik/mambaforge/envs/compmethods/lib/python3.11/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/erik/mambaforge/envs/compmethods/lib/python3.11/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
a = jnp.array([1.0, 2.0, 3.0])
b = jnp.array([4., 5., 6.])

------------------

----- stderr -----
2026-01-21 10:07:33.410816: E external/xla/xla/stream_executor/cuda/cuda_platform.cc:51] failed call to cuInit: INTERNAL: CUDA error: Failed call to cuInit: CUDA_ERROR_UNKNOWN: unknown error
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mXlaRuntimeError[0m                           Traceback (most recent call last)
    [0;31m[... skipping hidden 1 frame][0m

File [0;32m~/mambaforge/envs/compmethods/lib/python3.11/site-packages/jax/_src/xla_bridge.py:943[0m, in [0;36m_init_backend[0;34m(platform)[0m
[1;32m    942[0m logger[38;5;241m.[39mdebug([38;5;124m"[39m[38;5;124mInitializing backend [39m[38;5;124m'[39m[38;5;132;01m%s[39;00m[38;5;124m'[39m[38;5;124m"[39m, platform)
[0;32m--> 943[0m backend [38;5;241m=[39m [43mregistration[49m[38;5;241;43m.[39;49m[43mfactory[49m[43m([49m[43m)[49m
[1;32m    944[0m [38;5;66;03m# TODO(skye): consider raising more descriptive errors directly from backend[39;00m
[1;32m    945[0m [38;5;66;03m# factories instead of returning None.[39;00m

File [0;32m~/mambaforge/envs/compmethods/lib/python3.11/site-packages/jax/_src/xla_bridge.py:633[0m, in [0;36mregister_plugin.<locals>.factory[0;34m()[0m
[1;32m    632[0m [38;5;28;01mif[39;00m distributed[38;5;241m.[39mglobal_state[38;5;241m.[39mclient [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m--> 633[0m   [38;5;28;01mreturn[39;00m [43mxla_client[49m[38;5;241;43m.[39;49m[43mmake_c_api_client[49m[43m([49m[43mplugin_name[49m[43m,[49m[43m [49m[43mupdated_options[49m[43m,[49m[43m [49m[38;5;28;43;01mNone[39;49;00m[43m)[49m
[1;32m    635[0m distribute_options [38;5;241m=[39m {
[1;32m    636[0m     [38;5;124m'[39m[38;5;124mnode_id[39m[38;5;124m'[39m: distributed[38;5;241m.[39mglobal_state[38;5;241m.[39mprocess_id,
[1;32m    637[0m     [38;5;124m'[39m[38;5;124mnum_nodes[39m[38;5;124m'[39m: distributed[38;5;241m.[39mglobal_state[38;5;241m.[39mnum_processes,
[1;32m    638[0m }

File [0;32m~/mambaforge/envs/compmethods/lib/python3.11/site-packages/jaxlib/xla_client.py:159[0m, in [0;36mmake_c_api_client[0;34m(plugin_name, options, distributed_client)[0m
[1;32m    158[0m   options [38;5;241m=[39m {}
[0;32m--> 159[0m [38;5;28;01mreturn[39;00m [43m_xla[49m[38;5;241;43m.[39;49m[43mget_c_api_client[49m[43m([49m[43mplugin_name[49m[43m,[49m[43m [49m[43moptions[49m[43m,[49m[43m [49m[43mdistributed_client[49m[43m)[49m

[0;31mXlaRuntimeError[0m: FAILED_PRECONDITION: No visible GPU devices.

During handling of the above exception, another exception occurred:

[0;31mRuntimeError[0m                              Traceback (most recent call last)
Cell [0;32mIn[2], line 1[0m
[0;32m----> 1[0m a [38;5;241m=[39m [43mjnp[49m[38;5;241;43m.[39;49m[43marray[49m[43m([49m[43m[[49m[38;5;241;43m1.0[39;49m[43m,[49m[43m [49m[38;5;241;43m2.0[39;49m[43m,[49m[43m [49m[38;5;241;43m3.0[39;49m[43m][49m[43m)[49m
[1;32m      2[0m b [38;5;241m=[39m jnp[38;5;241m.[39marray([[38;5;241m4.[39m, [38;5;241m5.[39m, [38;5;241m6.[39m])

File [0;32m~/mambaforge/envs/compmethods/lib/python3.11/site-packages/jax/_src/numpy/lax_numpy.py:5548[0m, in [0;36marray[0;34m(object, dtype, copy, order, ndmin, device)[0m
[1;32m   5546[0m [38;5;28;01melse[39;00m:
[1;32m   5547[0m   [38;5;28;01mraise[39;00m [38;5;167;01mTypeError[39;00m([38;5;124mf[39m[38;5;124m"[39m[38;5;124mUnexpected input type for array: [39m[38;5;132;01m{[39;00m[38;5;28mtype[39m([38;5;28mobject[39m)[38;5;132;01m}[39;00m[38;5;124m"[39m)
[0;32m-> 5548[0m out_array: Array [38;5;241m=[39m [43mlax_internal[49m[38;5;241;43m.[39;49m[43m_convert_element_type[49m[43m([49m
[1;32m   5549[0m [43m    [49m[43mout[49m[43m,[49m[43m [49m[43mdtype[49m[43m,[49m[43m [49m[43mweak_type[49m[38;5;241;43m=[39;49m[43mweak_type[49m[43m,[49m[43m [49m[43msharding[49m[38;5;241;43m=[39;49m[43msharding[49m[43m)[49m
[1;32m   5550[0m [38;5;28;01mif[39;00m ndmin [38;5;241m>[39m np[38;5;241m.[39mndim(out_array):
[1;32m   5551[0m   out_array [38;5;241m=[39m lax[38;5;241m.[39mexpand_dims(out_array, [38;5;28mrange[39m(ndmin [38;5;241m-[39m np[38;5;241m.[39mndim(out_array)))

File [0;32m~/mambaforge/envs/compmethods/lib/python3.11/site-packages/jax/_src/lax/lax.py:1727[0m, in [0;36m_convert_element_type[0;34m(operand, new_dtype, weak_type, sharding, warn_on_complex_to_real_cast)[0m
[1;32m   1725[0m   [38;5;28;01mreturn[39;00m operand
[1;32m   1726[0m [38;5;28;01melse[39;00m:
[0;32m-> 1727[0m   [38;5;28;01mreturn[39;00m [43mconvert_element_type_p[49m[38;5;241;43m.[39;49m[43mbind[49m[43m([49m
[1;32m   1728[0m [43m      [49m[43moperand[49m[43m,[49m[43m [49m[43mnew_dtype[49m[38;5;241;43m=[39;49m[43mnew_dtype[49m[43m,[49m[43m [49m[43mweak_type[49m[38;5;241;43m=[39;49m[38;5;28;43mbool[39;49m[43m([49m[43mweak_type[49m[43m)[49m[43m,[49m
[1;32m   1729[0m [43m      [49m[43msharding[49m[38;5;241;43m=[39;49m[43msharding[49m[43m)[49m

File [0;32m~/mambaforge/envs/compmethods/lib/python3.11/site-packages/jax/_src/core.py:496[0m, in [0;36mPrimitive.bind[0;34m(self, *args, **params)[0m
[1;32m    494[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21mbind[39m([38;5;28mself[39m, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mparams):
[1;32m    495[0m   args [38;5;241m=[39m args [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mskip_canonicalization [38;5;28;01melse[39;00m [38;5;28mmap[39m(canonicalize_value, args)
[0;32m--> 496[0m   [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_true_bind[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mparams[49m[43m)[49m

File [0;32m~/mambaforge/envs/compmethods/lib/python3.11/site-packages/jax/_src/core.py:512[0m, in [0;36mPrimitive._true_bind[0;34m(self, *args, **params)[0m
[1;32m    510[0m trace_ctx[38;5;241m.[39mset_trace(eval_trace)
[1;32m    511[0m [38;5;28;01mtry[39;00m:
[0;32m--> 512[0m   [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mbind_with_trace[49m[43m([49m[43mprev_trace[49m[43m,[49m[43m [49m[43margs[49m[43m,[49m[43m [49m[43mparams[49m[43m)[49m
[1;32m    513[0m [38;5;28;01mfinally[39;00m:
[1;32m    514[0m   trace_ctx[38;5;241m.[39mset_trace(prev_trace)

File [0;32m~/mambaforge/envs/compmethods/lib/python3.11/site-packages/jax/_src/lax/lax.py:4875[0m, in [0;36m_convert_element_type_bind_with_trace[0;34m(trace, args, params)[0m
[1;32m   4873[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21m_convert_element_type_bind_with_trace[39m(trace, args, params):
[1;32m   4874[0m   sharding [38;5;241m=[39m params[[38;5;124m'[39m[38;5;124msharding[39m[38;5;124m'[39m]
[0;32m-> 4875[0m   operand [38;5;241m=[39m [43mcore[49m[38;5;241;43m.[39;49m[43mPrimitive[49m[38;5;241;43m.[39;49m[43mbind_with_trace[49m[43m([49m[43mconvert_element_type_p[49m[43m,[49m[43m [49m[43mtrace[49m[43m,[49m[43m [49m[43margs[49m[43m,[49m[43m [49m[43mparams[49m[43m)[49m
[1;32m   4876[0m   [38;5;28;01mif[39;00m sharding [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mand[39;00m sharding[38;5;241m.[39m_is_concrete:
[1;32m   4877[0m     [38;5;28;01mwith[39;00m core[38;5;241m.[39mset_current_trace(trace):

File [0;32m~/mambaforge/envs/compmethods/lib/python3.11/site-packages/jax/_src/core.py:517[0m, in [0;36mPrimitive.bind_with_trace[0;34m(self, trace, args, params)[0m
[1;32m    516[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21mbind_with_trace[39m([38;5;28mself[39m, trace, args, params):
[0;32m--> 517[0m   [38;5;28;01mreturn[39;00m [43mtrace[49m[38;5;241;43m.[39;49m[43mprocess_primitive[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43margs[49m[43m,[49m[43m [49m[43mparams[49m[43m)[49m

File [0;32m~/mambaforge/envs/compmethods/lib/python3.11/site-packages/jax/_src/core.py:1017[0m, in [0;36mEvalTrace.process_primitive[0;34m(self, primitive, args, params)[0m
[1;32m   1015[0m args [38;5;241m=[39m [38;5;28mmap[39m(full_lower, args)
[1;32m   1016[0m check_eval_args(args)
[0;32m-> 1017[0m [38;5;28;01mreturn[39;00m [43mprimitive[49m[38;5;241;43m.[39;49m[43mimpl[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mparams[49m[43m)[49m

File [0;32m~/mambaforge/envs/compmethods/lib/python3.11/site-packages/jax/_src/dispatch.py:89[0m, in [0;36mapply_primitive[0;34m(prim, *args, **params)[0m
[1;32m     87[0m prev [38;5;241m=[39m lib[38;5;241m.[39mjax_jit[38;5;241m.[39mswap_thread_local_state_disable_jit([38;5;28;01mFalse[39;00m)
[1;32m     88[0m [38;5;28;01mtry[39;00m:
[0;32m---> 89[0m   outs [38;5;241m=[39m [43mfun[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m)[49m
[1;32m     90[0m [38;5;28;01mfinally[39;00m:
[1;32m     91[0m   lib[38;5;241m.[39mjax_jit[38;5;241m.[39mswap_thread_local_state_disable_jit(prev)

    [0;31m[... skipping hidden 13 frame][0m

File [0;32m~/mambaforge/envs/compmethods/lib/python3.11/site-packages/jax/_src/xla_bridge.py:873[0m, in [0;36mbackends[0;34m()[0m
[1;32m    871[0m       [38;5;28;01melse[39;00m:
[1;32m    872[0m         err_msg [38;5;241m+[39m[38;5;241m=[39m [38;5;124m"[39m[38;5;124m (you may need to uninstall the failing plugin package, or set JAX_PLATFORMS=cpu to skip this backend.)[39m[38;5;124m"[39m
[0;32m--> 873[0m       [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m(err_msg)
[1;32m    875[0m [38;5;28;01massert[39;00m _default_backend [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m
[1;32m    876[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m config[38;5;241m.[39mjax_platforms[38;5;241m.[39mvalue:

[0;31mRuntimeError[0m: Unable to initialize backend 'cuda': FAILED_PRECONDITION: No visible GPU devices. (you may need to uninstall the failing plugin package, or set JAX_PLATFORMS=cpu to skip this backend.)

