
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>From ODE to PDE &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lecture-13-pde';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Optimization" href="lecture-14-optimization.html" />
    <link rel="prev" title="More on Numerical ODEs" href="lecture-12-symplectic-integrators.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="My sample book - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to 7870
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 1. Linear Algebra</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture-01-intro_vectors.html">A Deeper look at Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-02-coding_matrices_in_python.html">Linear Algebra in Python with Numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-03-matrix_decompositions.html">Eigenvectors, Unitary Matrices, and Matrix Decompositions</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-04-linear_regression.html">Linear Regression and Least Squares</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 2. Probability</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture-05-probability.html">Intro to Probability</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-05a-random-in-numpy.html">Using Random Numbers in Numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-06-bayes-rule.html">Conditional Probability and Bayes Rule</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-07-bayesian-inference.html">Bayesian Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-08-monte-carlo.html">Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-09-mcmc.html">Markov Chain Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-10-metropolis-hastings.html">Detailed Balance and the Metropolis-Hastings Algorithm</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 3. Numerical Differential Equations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture-11-ode-intro.html">Intro to Numerical Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-12-symplectic-integrators.html">More on Numerical ODEs</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">From ODE to PDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-14-optimization.html">Optimization</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Flecture-13-pde.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/lecture-13-pde.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>From ODE to PDE</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-pde">What is a PDE?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-on-prior-pde-solvers-we-ve-discussed">Recap on Prior PDE Solvers We’ve Discussed</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-difference-methods">Finite Difference Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-crank-nicolson-method">The Crank-Nicolson Method</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="from-ode-to-pde">
<h1>From ODE to PDE<a class="headerlink" href="#from-ode-to-pde" title="Link to this heading">#</a></h1>
<section id="learning-objectives">
<h2>Learning Objectives<a class="headerlink" href="#learning-objectives" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Understand the difference between ODEs and PDEs</p></li>
<li><p>Understand the basic structure of a PDE</p></li>
<li><p>Know how to solve a PDE using finite difference methods</p></li>
<li><p>Be able to implement the Crank-Nicolson method for solving PDEs</p></li>
</ul>
</section>
<section id="what-is-a-pde">
<h2>What is a PDE?<a class="headerlink" href="#what-is-a-pde" title="Link to this heading">#</a></h2>
<p>Partial differential equations generalize ordinary differential equations (ODEs) to functions of multiple variables.</p>
<p>The first part of a PDE is an equation that relating the partial derivatives of a function to each other.
For instance,</p>
<ul>
<li><p>The wave equation describes the propagation of waves in a medium and is given by:</p>
<div class="math notranslate nohighlight">
\[
  \frac{\partial^2 u}{\partial t^2} = c^2 \nabla^2 u(x, t)
  \]</div>
<p>where (u) is the wave function, (t) is time, and (\nabla^2) is the Laplacian operator.</p>
</li>
<li><p>The Schrodinger equation describes the evolution of quantum states and is given by:</p>
<div class="math notranslate nohighlight">
\[
  i\hbar \frac{\partial \psi}{\partial t} = -\frac{\hbar^2}{2m} \nabla^2 \psi(x) + V(x) \psi(x)
  \]</div>
<p>where (\psi) is the wave function, (V) is the potential energy, and (m) is the mass of the particle.</p>
</li>
<li><p>The Convection-Diffusion equation describes the transport of substances in a medium.  For an incompressible flow,  it is given by:</p>
<div class="math notranslate nohighlight">
\[
  \frac{\partial u}{\partial t} + v \cdot \nabla u = D \nabla^2 u
  \]</div>
<p>where (u) is the concentration of the substance, (v) is the velocity field, and (D) is the diffusion coefficient.</p>
</li>
<li><p>The Fokker-Planck equation describes the time evolution of the probability density function of a stochastic process.  It is given by:</p>
<div class="math notranslate nohighlight">
\[
  \frac{\partial P(x, t)}{\partial t} = -\nabla \cdot (v(x) P(x, t)) + D \nabla^2 P(x, t)
  \]</div>
<p>where (P) is the probability density function, (v(x)) is the drift velocity, and (D) is the diffusion coefficient.</p>
</li>
</ul>
<p>While these are time-dependent PDEs, we can also have time-independent PDEs.  (Often, these result from looking for steady states for time-dependent equaitons.)  For instance, the Poisson equation describes the potential field in electrostatics and is given by:</p>
<div class="math notranslate nohighlight">
\[
\nabla^2 u(x) = -\frac{\rho(x)}{\epsilon_0}
\]</div>
<p>where (u) is the potential, (\rho(x)) is the charge density, and (\epsilon_0) is the permittivity of free space.</p>
<p>The <em>second</em> part of a PDE is the boundary conditions and initial conditions, which specify how the function behaves at spatial and temporal boundaries respectively.
The initial conditions specify the state of the system at time (t=0), while the boundary conditions specify the behavior of the system at the spatial boundaries.
These boundary conditions can be of different types.  Two of note are:</p>
<ul class="simple">
<li><p><strong>Dirichlet boundary conditions</strong> specify the value of the function at the boundary.  (The wavefunction going to 0 at the endges of an infinite potential energy wall is an example of this.)</p></li>
<li><p><strong>Neumann boundary conditions</strong> specify the value of the derivative of the function at the boundary.
In other cases we might specify a combination of the two, or even a more complex condition.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A PDE is not complete with out its boundary and initial conditions!  They are essential to solving the PDE. If they change, the solution may change drastically.</p>
</div>
<section id="recap-on-prior-pde-solvers-we-ve-discussed">
<h3>Recap on Prior PDE Solvers We’ve Discussed<a class="headerlink" href="#recap-on-prior-pde-solvers-we-ve-discussed" title="Link to this heading">#</a></h3>
<p>We have already written down a PDE solver without discussing it in February!
In a previous homework, we attempted to solve the Schrodinger equation by</p>
<ol class="arabic simple">
<li><p>Introducing a Basis Set expansion of the wavefunction</p></li>
<li><p>Writing down a matrix representation of the Hamiltonian that gives the time-evolution of the coefficients.</p></li>
<li><p>Diagonalizing the Hamiltonian to find the eigenvalues and eigenvectors and use them to time-evolve the system.</p></li>
</ol>
<p>This is an example of an approach known as a spectral method: we decompose the solution into a linear combination of basis functions and then solve for the coefficients of these basis functions.
Note that it is necessary that the basis set obeys the boundary conditions of the problem.  For instance, if we are solving the Schrodinger equation with Dirichlet boundary conditions, we need to use a basis set that goes to zero at the boundaries.  (The Fourier basis does not do this, but the sine basis does.)</p>
<p>Spectral methods are often very powerful approaches, but they have their limitations.  For instance, it is not clear how to apply this to a PDE with non-linear terms.  (The Schrodinger equation is linear in the wavefunction, but other PDEs,
such as the Kuramoto-Sivashinsky equation <span class="math notranslate nohighlight">\(\partial_t u = -\partial_x^2 u - \partial_x^4 u - \partial_x (u^2)\)</span> are not.)
Moreover, the basis set expansion is not always the most efficient way to represent the solution: a bad basis set may converge slowly, or lead to ringing artifacts.
Finally, expanding the size of the basis set can lead to a large dense matrix: increasing computational expense.</p>
</section>
</section>
<section id="finite-difference-methods">
<h2>Finite Difference Methods<a class="headerlink" href="#finite-difference-methods" title="Link to this heading">#</a></h2>
<p>Here, we discuss a different approach to solving PDEs, known as finite difference methods.
In Finite difference methods, we evaluate the function an a grid of points.
We then approximate the derivatives in the PDE using finite differences,
similar to the approach we took when discussing ODE solvers.
For instance, we can approximate the first derivative of a function (u(x)) at point (x) using a forward difference:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial u}{\partial x} \approx \frac{u(x + \Delta x) - u(x)}{\Delta x}
\]</div>
<p>a backward difference:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial u}{\partial x} \approx \frac{u(x) - u(x - \Delta x)}{\Delta x}
\]</div>
<p>or a central difference:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial u}{\partial x} \approx \frac{u(x + \Delta x) - u(x - \Delta x)}{2 \Delta x}
\]</div>
<p>Similarly, we can approximate the second derivative of a function (u(x)) at point (x) using a central difference:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial^2 u}{\partial x^2} \approx \frac{u(x + \Delta x) - 2 u(x) + u(x - \Delta x)}{\Delta x^2}
\]</div>
<p>These operators can be written as matrices as well.  For instance, the second derivative operator can be written as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
D_2 = \frac{1}{\Delta x^2}
\begin{pmatrix}
 \ddots &amp; \ddots &amp;\ddots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots \\
 \ddots &amp; 1      &amp;-2     &amp; 1      &amp; 0      &amp; 0      &amp; \ddots \\
 \ddots &amp; 0      &amp;1      &amp; -2     &amp; 1      &amp; 0      &amp; \ddots \\
 \ddots &amp; 0      &amp;0      &amp; 1      &amp; -2     &amp; 1      &amp; \ddots \\
 \ddots &amp; \ddots &amp;\ddots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots
\end{pmatrix}
\end{split}\]</div>
<p>(The values in the corners depend on the boundary conditions.)  While this is a large matrix, it is sparse: most of the entries are zero.  This can often lead to much faster computations.</p>
<p>Once we have these finite difference approximations, we can substitute them into the PDE to get a set of ODEs that give the time-evolution of the function at each point in space.
For instance, consider the simple diffusion equation</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial u}{\partial t} =  \partial_x^2 u(x, t)
\]</div>
<p>Applying the finite difference approximation to the second derivative, we get</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial u_{i}}{\partial t}(t) = \frac{u_{i+1}(t) - 2 u_{i}(t) + u_{i-1}(t)}{\Delta x^2}
\]</div>
<p>where (u_i) is the value of the function at point (i) in space.</p>
<section id="the-crank-nicolson-method">
<h3>The Crank-Nicolson Method<a class="headerlink" href="#the-crank-nicolson-method" title="Link to this heading">#</a></h3>
<p>One of the most common finite difference methods is the Crank-Nicolson method.  In Crank-Nicolson, we</p>
<ol class="arabic simple">
<li><p>Use central difference to approximate spacial derivatives in the PDE</p></li>
<li><p>Integrate the resulting ODEs using the trapezoidal rule.</p></li>
</ol>
<p>This is a very stable method, and is commonly used for PDEs that model diffusions or other dissipative processes.
For other PDEs it is not necessarily the most efficient method, but it is a reasonably ``safe’’ option.</p>
<p>If we attempt to solve the simple diffusion equation above using the Crank-Nicolson method, we get</p>
<div class="math notranslate nohighlight">
\[
\begin{split}
    u_i(t + \Delta t) = u_i(t) + \frac{\Delta t}{2} \left( \frac{u_{i+1}(t) - 2 u_{i}(t) + u_{i-1}(t)}{\Delta x^2} + \frac{u_{i+1}(t + \Delta t) - 2 u_{i}(t + \Delta t) + u_{i-1}(t + \Delta t)}{\Delta x^2} \right)
\end{split}
\]</div>
<p>or using the <span class="math notranslate nohighlight">\(D_2\)</span> matrix we defined above:</p>
<div class="math notranslate nohighlight">
\[
    u(t + \Delta t) = u(t) + \frac{\Delta t}{2} \left( D_2 u(t) + D_2 u(t + \Delta t) \right)
\]</div>
<p>Note that for this (and for many other PDEs) we can solve for the function at <span class="math notranslate nohighlight">\(u(t + \Delta t)\)</span> using linear algebra:</p>
<div class="math notranslate nohighlight">
\[
    \left( I - \frac{\Delta t}{2} D_2 \right) u(t + \Delta t) = \left( I + \frac{\Delta t}{2} D_2 \right) u(t)
\]</div>
<p>implying</p>
<div class="math notranslate nohighlight">
\[
    u(t + \Delta t) = \left( I - \frac{\Delta t}{2} D_2 \right)^{-1} \left( I + \frac{\Delta t}{2} D_2 \right) u(t)
\]</div>
<p>(A proof that this matrix is invertible is beyond the scope of this class.)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In practice, you don’t actually want to invert the matrix since this very computationally expensive.  Instead, it is better to solve the previous equation,
observing that it takes the form</p>
<div class="math notranslate nohighlight">
\[
A x = b
\]</div>
<p>where <span class="math notranslate nohighlight">\(A = \left( I - \frac{\Delta t}{2} D_2 \right)\)</span>, <span class="math notranslate nohighlight">\(x = u(t + \Delta t)\)</span>, and <span class="math notranslate nohighlight">\(b = \left( I + \frac{\Delta t}{2} D_2 \right) u(t)\)</span>,
and you can leverage extensive work put into solving sparse linear algebra equations, e.g. the methods in <code class="docutils literal notranslate"><span class="pre">scipy.sparse.linalg</span></code>.</p>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lecture-12-symplectic-integrators.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">More on Numerical ODEs</p>
      </div>
    </a>
    <a class="right-next"
       href="lecture-14-optimization.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Optimization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-pde">What is a PDE?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-on-prior-pde-solvers-we-ve-discussed">Recap on Prior PDE Solvers We’ve Discussed</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-difference-methods">Finite Difference Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-crank-nicolson-method">The Crank-Nicolson Method</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Erik Thiede
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>